--- package/lean/default-settings/files/zzz-default-settings	2022-10-03 02:12:01.386585160 +0800
+++ package/lean/default-settings/files/zzz-default-settings	2022-10-03 08:17:56.299437800 +0800
@@ -36,11 +36,12 @@ sed -i 's/root::0:0:99999:7:::/root:$1$V
 sed -i "s/# //g" /etc/opkg/distfeeds.conf
 sed -i '/openwrt_luci/ { s/snapshots/releases\/18.06.9/g; }'  /etc/opkg/distfeeds.conf
 
-sed -i '/REDIRECT --to-ports 53/d' /etc/firewall.user
-echo 'iptables -t nat -A PREROUTING -p udp --dport 53 -j REDIRECT --to-ports 53' >> /etc/firewall.user
-echo 'iptables -t nat -A PREROUTING -p tcp --dport 53 -j REDIRECT --to-ports 53' >> /etc/firewall.user
-echo '[ -n "$(command -v ip6tables)" ] && ip6tables -t nat -A PREROUTING -p udp --dport 53 -j REDIRECT --to-ports 53' >> /etc/firewall.user
-echo '[ -n "$(command -v ip6tables)" ] && ip6tables -t nat -A PREROUTING -p tcp --dport 53 -j REDIRECT --to-ports 53' >> /etc/firewall.user
+if [ "$(sed -n '/^# automatically generated by default-settings on the first boot/p' /etc/firewall.user)" == '' ]; then
+	echo -n '
+# automatically generated by default-settings on the first boot
+%custom_firewall%
+' >> /etc/firewall.user
+fi
 
 sed -i '/option disabled/d' /etc/config/wireless
 sed -i '/set wireless.radio${devidx}.disabled/d' /lib/wifi/mac80211.sh
